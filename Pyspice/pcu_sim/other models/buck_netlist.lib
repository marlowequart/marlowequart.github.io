.subckt buck_netlist input_v duty_cycle period
XX1 input_v duty_cycle period
.ends buck_netlist



******************************************************************************************************************
* STEPS TO GET FROM LTSPICE NETLIST TO THIS NGSPICE NETLIST:
* Delete everything that's not a subcircuit (including end of file top-level statements such as .tran, .end);
* This file is only a collection of subcircuits, not a complete SPICE netlist.
* Add parameters to each subckt line (just copy from any instantiation of said subcircuit; do not include "params:")
* Change unicode 'mu' to 'u'
* Replace any dash in any subcircuit name with an underscore 
* Add top subcircuit ngspice_top using instantiation line for XX1 in original top-level netlist (see text before this note)
*	It is important to include the XX1 instantiation as above otherwise the models below do not get connected
******************************************************************************************************************

.subckt buck_netlist input_v duty_cycle period
V1 Vin 0 input_v
C1 P001 0 10u
R1 Vin P001 20m
L1 N001 P002 150u
D1 0 N001 1N5819
C2 output 0 22u
R2 N002 P002 100m
R3 N002 output 20m
R4 N002 0 5
V2 gate_drive 0 PULSE(0 10 0 1n 1n duty_cycle period 200)
M1 N001 N003 Vin Vin DMG4435SSS
R6 N003 Vin 10
*S1 0 N003 gate_drive 0 SW1
M2 N003 N003 gate_drive 0 irf150


*.model SW1 SW Ron=0.002 Roff=1Meg Vt=3.0
.model 1N5819 D Is=31.7u Rs=.051 N=1.373 Cjo=110p M=.35 Eg=.69 Xti=2 Iave=1 Vpk=40 mfg=OnSemi type=Schottky

*.lib C:\PROGRA~2\LTC\LTSPIC~1\lib\cmp\standard.dio
*.model NMOS NMOS
*.model PMOS PMOS
*.lib C:\PROGRA~2\LTC\LTSPIC~1\lib\cmp\standard.mos
*.backanno
.ends buck_netlist


*---------- DMG4435SSS Spice Model ----------
.SUBCKT DMG4435SSS 10 20 30 
*     TERMINALS:  D  G  S
M1 1 2 3 3  PMOS  L = 1E-006  W = 1E-006 
RD 10 1 0.01231 
RS 30 3 0.001 
RG 20 2 6.83 
CGS 2 3 1.465E-009 
EGD 12 30 2 1 1 
VFB 14 30 0 
FFB 2 1  VFB 1 
CGD 13 14 1.556E-009 
R1 13 30 1 
D1 13 12  DLIM 
DDG 14 15  DCGD 
R2 12 15 1 
D2 30 15  DLIM 
DSD 10 3  DSUB 
.MODEL PMOS PMOS  LEVEL = 3  U0 = 164.9  VMAX = 1.945E+005  KP = 39.94 
+ ETA = 0.005129  TOX = 6E-008  NSUB = 1.104E+016  KAPPA = 3.689  VTO = -2.072 
.MODEL DCGD D  CJO = 7.47E-010  VJ = 0.518  M = 0.3662 
.MODEL DSUB D  IS = 2.364E-010  N = 1.296  RS = 0.007836  BV = 33  
+CJO = 9.148E-011  VJ = 0.644  M = 0.663 
.MODEL DLIM D  IS = 0.0001 
.ENDS DMG4435SSS
*Diodes DMG4435SSS Spice Model v1.0 Last Revised 2010/9/14





.SUBCKT irf150 1 2 3
**************************************
*      Model Generated by MODPEX     *
*Copyright(c) Symmetry Design Systems*
*         All Rights Reserved        *
*    UNPUBLISHED LICENSED SOFTWARE   *
*   Contains Proprietary Information *
*      Which is The Property of      *
*     SYMMETRY OR ITS LICENSORS      *
*Commercial Use or Resale Restricted *
*   by Symmetry License Agreement    *
**************************************
* Model generated on Dec 17, 96
* MODEL FORMAT: SPICE3
* Symmetry POWER MOS Model (Version 1.0)
* External Node Designations
* Node 1 -> Drain
* Node 2 -> Gate
* Node 3 -> Source
M1 9 7 8 8 MM L=100u W=100u
* Default values used in MM:
* The voltage-dependent capacitances are
* not included. Other default values are:
*   RS=0 RD=0 LD=0 CBD=0 CBS=0 CGBO=0
.MODEL MM NMOS LEVEL=1 IS=1e-32
+VTO=4.07861 LAMBDA=0.000761669 KP=19.0218
+CGSO=3.57784e-05 CGDO=4.96221e-07
RS 8 3 0.0216597
D1 3 1 MD
.MODEL MD D IS=2.01865e-09 RS=0.11592 N=1.5 BV=100
+IBV=0.001 EG=1 XTI=1 TT=1e-07
+CJO=3.28974e-09 VJ=4.39387 M=0.659734 FC=0.1
RDS 3 1 3.2e+06
RD 9 1 0.00224103
RG 2 7 12.1
D2 4 5 MD1
* Default values used in MD1:
*   RS=0 EG=1.11 XTI=3.0 TT=0
*   BV=infinite IBV=1mA
.MODEL MD1 D IS=1e-32 N=50
+CJO=3.78329e-09 VJ=0.607074 M=0.893797 FC=1e-08
D3 0 5 MD2
* Default values used in MD2:
*   EG=1.11 XTI=3.0 TT=0 CJO=0
*   BV=infinite IBV=1mA
.MODEL MD2 D IS=1e-10 N=0.402271 RS=3.00001e-06
RL 5 10 1
FI2 7 9 VFI2 -1
VFI2 4 0 0
EV16 10 0 9 7 1
CAP 11 10 3.78329e-09
FI1 7 9 VFI1 -1
VFI1 11 6 0
RCAP 6 10 1
D4 0 6 MD3
* Default values used in MD3:
*   EG=1.11 XTI=3.0 TT=0 CJO=0
*   RS=0 BV=infinite IBV=1mA
.MODEL MD3 D IS=1e-10 N=0.402271
.ENDS irf150





*V1 Vin 0 input_v
*C1 P001 0 10u
*R1 Vin P001 20m
*L1 N001 P002 150u
*D1 0 N001 1N5819
*C2 P003 0 22u
*R2 N002 P002 100m
*R3 N002 P003 20m
*R4 N002 0 5
*V2 gate_drive 0 PULSE(0 10 0 1n 1n duty_cycle period 200)
*M1 N001 N003 Vin Vin FDS6675
*R6 N003 Vin 10
*S1 0 N003 gate_drive 0 SW

*.model D D
*.lib C:\PROGRA~2\LTC\LTSPIC~1\lib\cmp\standard.dio
*.model NMOS NMOS
*.model PMOS PMOS
*.lib C:\PROGRA~2\LTC\LTSPIC~1\lib\cmp\standard.mos
*.model SW SW(Ron=0.002 Roff=1Meg Vt=3.0)
*.backanno
*.end